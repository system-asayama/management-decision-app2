# Phase 5: ダッシュボード実装計画

## 目標
財務指標の計算・表示、グラフによる可視化、複数年度比較機能を実装する

## 実装内容

### 1. 財務指標計算ロジック

#### 収益性指標
- [ ] 売上高営業利益率 = 営業利益 / 売上高 × 100
- [ ] 売上高経常利益率 = 経常利益 / 売上高 × 100
- [ ] 売上高当期純利益率 = 当期純利益 / 売上高 × 100
- [ ] ROA（総資産利益率） = 当期純利益 / 総資産 × 100
- [ ] ROE（自己資本利益率） = 当期純利益 / 純資産 × 100

#### 安全性指標
- [ ] 流動比率 = 流動資産 / 流動負債 × 100
- [ ] 当座比率 = (流動資産 - 棚卸資産) / 流動負債 × 100
- [ ] 固定比率 = 固定資産 / 純資産 × 100
- [ ] 自己資本比率 = 純資産 / 総資産 × 100
- [ ] 負債比率 = 総負債 / 純資産 × 100

#### 効率性指標
- [ ] 総資産回転率 = 売上高 / 総資産
- [ ] 固定資産回転率 = 売上高 / 固定資産
- [ ] 流動資産回転率 = 売上高 / 流動資産

### 2. ダッシュボードUI

#### 企業・年度選択
- [ ] 企業選択ドロップダウン
- [ ] 会計年度選択ドロップダウン
- [ ] 「分析実行」ボタン

#### 財務指標表示
- [ ] 収益性指標カード（3指標）
- [ ] 安全性指標カード（5指標）
- [ ] 効率性指標カード（3指標）
- [ ] 各指標に色分け表示（良好=緑、注意=黄、警告=赤）

#### グラフ表示
- [ ] 売上高・利益推移グラフ（折れ線グラフ）
- [ ] 資産・負債・純資産推移グラフ（積み上げ棒グラフ）
- [ ] 財務指標推移グラフ（レーダーチャート）

### 3. バックエンド実装

#### ヘルパー関数（app/utils/financial_calculator.py）
- [ ] calculate_profitability_ratios() - 収益性指標計算
- [ ] calculate_safety_ratios() - 安全性指標計算
- [ ] calculate_efficiency_ratios() - 効率性指標計算
- [ ] get_multi_year_data() - 複数年度データ取得

#### ルート（app/blueprints/decision.py）
- [ ] /decision/dashboard - ダッシュボードページ
- [ ] /decision/dashboard/data/<company_id>/<fiscal_year_id> - 財務指標データAPI

### 4. フロントエンド実装

#### テンプレート
- [ ] dashboard.html - ダッシュボードメインページ
- [ ] dashboard_charts.html - グラフ表示ページ（オプション）

#### JavaScript
- [ ] Chart.jsライブラリの読み込み
- [ ] グラフ描画スクリプト
- [ ] 企業・年度選択時の動的データ更新

### 5. デプロイ

- [ ] GitHubにコミット
- [ ] Herokuにデプロイ
- [ ] 本番環境でテスト

## 技術スタック

- **バックエンド**: Python, Flask, SQLAlchemy
- **フロントエンド**: HTML, Tailwind CSS, JavaScript
- **グラフライブラリ**: Chart.js（軽量で使いやすい）
- **データベース**: PostgreSQL

## 実装順序

1. 財務指標計算ロジック（financial_calculator.py）
2. ダッシュボードルート（decision.py）
3. ダッシュボードテンプレート（dashboard.html）
4. グラフ機能（Chart.js）
5. デプロイとテスト

## 完了条件

- [x] Phase 4完了（損益計算書・貸借対照表CRUD）
- [ ] 財務指標が正しく計算される
- [ ] ダッシュボードが表示される
- [ ] グラフが正しく描画される
- [ ] 本番環境で動作する
